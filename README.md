# ValutaTrade Hub

ValutaTrade Hub — учебное консольное (CLI) приложение для управления валютным портфелем пользователя.

Назначение проекта:
- регистрация и аутентификация пользователя;
- хранение портфеля валют;
- покупка и продажа валют по курсам;
- получение текущих курсов валют с кешированием и заглушкой Parser Service.

Проект реализован как учебный, с упором на чёткую бизнес-логику, валидацию данных,
отказоустойчивость и воспроизводимость проверок.

---

## Рабочий каталог (Ubuntu)

/home/student/projects/finalproject_Andreenko_Andrey_dpo_v2

---

## Репозиторий GitHub

https://github.com/AndreyAU/finalproject_Andreenko_Andrey_dpo_v2

---

## Структура проекта

finalproject_Andreenko_Andrey_dpo_v2/
├── data/
│   ├── users.json           — зарегистрированные пользователи
│   ├── portfolios.json      — портфели пользователей
│   ├── rates.json           — кеш курсов валют + last_refresh
│   └── current_user.json    — текущая пользовательская сессия
│
├── valutatrade_hub/
│   ├── cli/
│   │   └── interface.py     — CLI-меню и обработка пользовательского ввода
│   │
│   └── core/
│       ├── models.py        — модель пользователя (хеширование, проверка пароля)
│       ├── usecases.py      — бизнес-логика (use cases)
│       └── utils.py         — работа с JSON и курсами валют
│
├── Makefile                 — команды install/project/build/publish/package-install/lint
├── .gitignore               — исключения для мусора, сборок и runtime-файлов
└── README.md                — документация проекта

---

## Установка

Проект не использует сторонние библиотеки и работает на стандартной библиотеке Python.

Требования:
- Python 3.9+

Формальная установка (по ТЗ):
make install

Команда не требует прав администратора и не устанавливает внешние зависимости.

---

## Запуск приложения

Рекомендуемый способ запуска:
make project

Альтернативный запуск напрямую:
python3 -m valutatrade_hub.cli.interface

---

## Команды CLI (демо)

После запуска отображается меню:

1. Регистрация
2. Вход
3. Показать портфель
4. Купить валюту
5. Продать валюту
6. Получить курс валют
0. Выход

Логика доступа:
- регистрация и вход доступны всегда;
- остальные команды требуют активной пользовательской сессии.

---

## Кеш курсов валют и TTL

Кеш курсов хранится в файле:
data/rates.json

Алгоритм работы:
1. Выполняется валидация кодов валют.
2. Пытаемся взять курс из кеша.
3. Проверяется актуальность курса (TTL = 5 минут).
4. Если курс отсутствует или устарел:
   - используется Parser Service (заглушка);
   - курс сохраняется в rates.json;
   - обновляется время последнего обновления.

Важно:
- инвертация курса не используется;
- если прямого курса нет — он считается недоступным (строго по ТЗ).

---

## Parser Service

Parser Service реализован в виде заглушки и используется автоматически при
отсутствии или устаревании кеша.

В реальном проекте на его месте мог бы быть внешний API.
API-ключи в текущей реализации не используются.

При использовании реального сервиса ключ должен храниться вне репозитория
(например, через переменные окружения).

---

## Проверка качества кода

Для проверки синтаксиса и базовой корректности используется:
make lint

---

## Другие цели Makefile

По ТЗ в проекте присутствуют цели:
- make build
- make publish
- make package-install

Цели реализованы в учебном режиме и не приводят к ошибкам выполнения.

---

## Хранилища данных

Используются JSON-файлы:
- data/users.json — пользователи
- data/portfolios.json — портфели
- data/rates.json — кеш курсов валют
- data/current_user.json — текущая сессия пользователя

Все изменения сохраняются на диск сразу после выполнения операций.

---

## Git-дисциплина

Все значимые изменения фиксируются отдельными коммитами:
- добавление и изменение бизнес-логики;
- усиление проверок ввода;
- исправление ошибок;
- изменения Makefile и .gitignore;
- правки формата данных и JSON.

---

## Демо работы приложения (asciinema) по реализации этапа 2. "Платформа для отслеживания и симуляции торговли валютами"

Полный сценарий работы CLI:
- регистрация и логин;
- покупка и продажа валют;
- просмотр портфеля;
- получение курса валют;
- обработка ошибок;
- демонстрация работы кеша и TTL.

Запись демо:
-> https://asciinema.org/a/TYdDWIJxHNI6K1BN

